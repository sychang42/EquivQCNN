Search.setIndex({"docnames": ["README", "circuits", "data_embedding", "dataset", "datasets", "equiv_unitary", "eurosat", "index", "metrics", "model_utils", "models", "qcnn", "qcnn_classifier", "quantum_circuit", "run", "semeion", "src", "train", "unitary", "utils"], "filenames": ["README.rst", "circuits.rst", "data_embedding.rst", "dataset.rst", "datasets.rst", "equiv_unitary.rst", "eurosat.rst", "index.rst", "metrics.rst", "model_utils.rst", "models.rst", "qcnn.rst", "qcnn_classifier.rst", "quantum_circuit.rst", "run.rst", "semeion.rst", "src.rst", "train.rst", "unitary.rst", "utils.rst"], "titles": ["About the codes", "circuits", "data_embedding module", "dataset module", "datasets", "equiv_unitary module", "eurosat module", "Equivariant QCNN for images", "metrics module", "model_utils module", "models", "qcnn module", "qcnn_classifier module", "quantum_circuit module", "run module", "semeion module", "src", "train module", "unitary module", "utils module"], "terms": {"approxim": [0, 7], "equivari": [0, 2, 12, 13, 17, 18], "quantum": [0, 2, 8, 9, 12, 13, 17, 18], "neural": [0, 3, 12, 13, 17, 18], "network": [0, 12, 13, 17, 18], "p4m": [0, 7], "group": [0, 7], "symmetri": [0, 7], "imag": [0, 2, 3, 12, 17], "classif": [0, 7, 17, 18], "us": [0, 7, 8, 12, 13, 17, 18], "an": [0, 7, 12, 13, 17], "convolut": [0, 12, 17, 18], "base": [0, 5, 6, 7, 11, 12, 15, 17, 18], "inher": [0, 7], "input": [0, 7, 8, 9, 17], "dataset": [0, 6, 7, 15, 16, 17], "explor": [0, 7], "doc": [0, 7], "paper": [0, 7, 18], "view": [0, 7], "demo": [0, 7], "report": [0, 7], "bug": [0, 7], "request": [0, 7], "featur": [0, 7], "thi": [0, 7, 18], "repositori": [0, 7, 15], "contain": [0, 7, 17, 18], "train": [0, 3, 7, 8, 9, 10, 15, 16], "qcnn": [0, 1, 9, 10, 13, 16, 17, 18], "under": [0, 7], "task": [0, 7], "The": [0, 3, 7, 8, 9, 17, 18], "i": [0, 2, 3, 5, 7, 8, 9, 12, 13, 17], "written": [0, 7], "jax": [0, 3, 7, 17], "util": [0, 3, 7, 9, 16], "pennylan": [0, 7], "oper": [0, 5, 7, 18], "back": [0, 7], "top": [0, 7], "To": [0, 7, 17], "model": [0, 3, 7, 9, 11, 13, 16, 17], "follow": [0, 3, 7, 17], "command": [0, 7], "python": [0, 7], "run": [0, 7, 16], "py": [0, 7], "config": [0, 7, 19], "yaml": [0, 7], "gpu": [0, 7], "0": [0, 2, 3, 5, 6, 7, 17, 18], "configur": [0, 7, 9, 13], "file": [0, 7], "should": [0, 5, 7, 17, 18], "structur": [0, 7], "dataset_param": [0, 7], "data": [0, 3, 6, 7, 9, 11, 17, 18], "name": [0, 3, 7, 10, 12, 16], "img_siz": [0, 3, 7, 17], "size": [0, 3, 7, 8, 17], "class": [0, 3, 5, 6, 7, 9, 11, 12, 15, 17, 18], "list": [0, 2, 3, 5, 7, 8, 9, 17, 18], "integ": [0, 3, 7, 17], "repres": [0, 3, 7, 17], "current": [0, 7, 9, 17], "onli": [0, 7, 9, 17], "binari": [0, 7, 8], "implement": [0, 3, 7, 9, 17], "n_data": [0, 7], "number": [0, 7, 8, 9, 12, 13, 17], "sampl": [0, 3, 7, 12], "set": [0, 3, 7, 17, 18], "null": [0, 7], "entir": [0, 7], "training_param": [0, 7], "num_epohc": [0, 7], "epoch": [0, 7, 9, 17], "batchsiz": [0, 7, 17], "batch": [0, 7, 8, 17], "loss_typ": [0, 7, 8, 17], "type": [0, 3, 5, 7, 8, 9, 12, 17, 18], "loss": [0, 7, 8, 9, 17], "function": [0, 3, 7, 9, 12, 19], "cross": [0, 7, 8], "entropi": [0, 7, 8], "bce": [0, 7, 8, 17], "model_param": [0, 7], "num_wir": [0, 1, 5, 7, 10, 17, 18], "qubit": [0, 7, 13, 17], "classifi": [0, 7, 8, 9, 12, 13, 17], "equiv": [0, 7, 10, 12, 13, 16, 17], "boolean": [0, 7, 12, 13, 17], "indic": [0, 12, 13, 17], "whether": [0, 7, 12, 13, 17], "trans_inv": [0, 7, 11, 13, 17], "construct": [0, 7, 13, 17], "translat": [0, 7, 13, 17], "invari": [0, 7, 13, 17], "wai": [0, 2, 3, 7, 13], "ver": [0, 7, 17], "circuit": [0, 2, 7, 10, 11, 12, 13, 16, 17, 18], "architectur": [0, 7, 17, 18], "version": [0, 7, 17], "symmetry_break": [0, 7, 17], "rz": [0, 7, 17], "gate": [0, 7, 17], "end": [0, 7, 13, 17], "case": [0, 3, 7, 13, 17], "equivqcnn": [0, 1, 7, 10, 11, 13, 16, 17], "delta": [0, 7, 10, 12, 16], "rang": [0, 7, 12], "uniform": [0, 7, 12], "distribut": [0, 7, 12], "from": [0, 3, 7, 12, 18], "which": [0, 7, 12, 17], "initi": [0, 7, 9, 12], "paramet": [0, 2, 3, 5, 7, 8, 9, 12, 13, 17, 18], "ar": [0, 3, 7, 12, 17, 18], "opt_param": [0, 7], "lr": [0, 7], "learn": [0, 7, 13, 15, 17], "rate": [0, 7, 17], "b1": [0, 7, 17], "beta_1": [0, 7, 17], "valu": [0, 7, 8, 17], "adam": [0, 7, 17], "optim": [0, 7, 9, 17], "9": [0, 6, 7, 17], "default": [0, 3, 7, 17], "b2": [0, 7, 17], "beta_2": [0, 7, 17], "999": [0, 7, 17], "logging_param": [0, 7], "save_dir": [0, 7, 19], "root": [0, 3, 6, 7, 15], "directori": [0, 3, 7, 17], "store": [0, 5, 7, 17, 18], "result": [0, 7, 17], "If": [0, 3, 7, 17], "misc": [0, 7], "chang2023approxim": [0, 7], "titl": [0, 7], "author": [0, 7], "su": [0, 7], "yeon": [0, 7], "chang": [0, 7], "michel": [0, 7], "grossi": [0, 7], "bertrand": [0, 7], "le": [0, 7], "saux": [0, 7], "sofia": [0, 7], "vallecorsa": [0, 7], "year": [0, 7], "2023": [0, 7], "eprint": [0, 7], "2310": [0, 7], "02323": [0, 7], "archiveprefix": [0, 7], "arxiv": [0, 7], "primaryclass": [0, 7], "quant": [0, 7], "ph": [0, 7], "apach": [0, 7], "see": [0, 7], "txt": [0, 7], "more": [0, 7], "inform": [0, 7], "sychang97": [0, 7], "cern": [0, 7], "ch": [0, 7], "project": [0, 7], "link": [0, 7], "http": [0, 7, 15], "github": [0, 7], "com": [0, 7], "sychang42": [0, 7], "data_embed": [1, 10, 16], "modul": [1, 4, 7, 10, 16], "embed_imag": [1, 2, 10, 16], "equiv_unitari": [1, 10, 16], "isingz4": [1, 5, 10, 16], "pooling_ansatz": [1, 5, 10, 16, 18], "compute_decomposit": [1, 5, 10, 18], "grad_method": [1, 5, 10, 18], "ndim_param": [1, 5, 10, 18], "num_param": [1, 5, 10, 12, 16, 18], "equiv_u2": [1, 5, 10, 16], "equiv_u4": [1, 5, 10, 16], "get_circuit": [1, 10, 11], "qnn_config_path": [1, 10, 11], "quantum_circuit": [1, 10, 16], "get_quantum_circuit": [1, 10, 13, 16], "unitari": [1, 10, 16], "u_6": [1, 10, 16, 18], "u_so4": [1, 10, 16, 18], "u_ttn": [1, 10, 16, 18], "embed": 2, "classic": [2, 3, 17, 18], "img": 2, "arrai": [2, 3, 5, 8, 9, 12, 17], "wire": [2, 5, 18], "int": [2, 3, 9, 11, 12, 13, 17], "none": [2, 3, 5, 6, 9, 12, 13, 15, 17, 18], "sourc": [2, 3, 5, 6, 8, 9, 11, 12, 13, 15, 17, 18, 19], "emb": 2, "reflect": 2, "rotat": [2, 5], "coordin": 2, "awar": 2, "amplitud": 2, "u": [2, 5], "x": [2, 8], "ket": 2, "sum_i": 2, "1": [2, 8, 17], "n": [2, 8], "x_": 2, "j": 2, "jnp": [2, 3, 12, 17], "ndarrai": [2, 3, 12, 17], "order": [2, 3], "load": [3, 9, 13, 17], "Ising": 3, "mnist": 3, "fashionmnist": 3, "emnist": 3, "eurosat": [3, 4, 7, 16], "semeion": [3, 4, 7, 16], "get_data": [3, 4, 16], "str": [3, 8, 9, 12, 13, 17], "load_dir": 3, "tupl": [3, 9, 11, 13, 17], "where": [3, 8], "locat": 3, "imgs_siz": 3, "union": [3, 13], "return": [3, 5, 8, 9, 12, 13, 17, 18], "all": [3, 17], "test": [3, 17], "label": [3, 8, 9, 17], "output": [3, 9, 17], "x_train": 3, "shape": [3, 8, 9, 12, 17], "num_train": 3, "num_channel": 3, "y_train": 3, "x_test": 3, "num_test": 3, "load_ising_data": [3, 4, 16], "l": [3, 8, 17, 18], "prepare_ising_data": [3, 4, 16], "numpi": 3, "dtype": 3, "float32": 3, "test_siz": 3, "float": [3, 5, 12, 17], "2": [3, 5, 8, 13, 17, 18], "validation_s": 3, "5000": 3, "prepar": 3, "2d": 3, "trainabl": [3, 5, 12, 18], "newtork": 3, "code": 3, "origin": 3, "taken": [3, 18], "notebook": 3, "12": 3, "identifi": 3, "phase": 3, "tensorflow": 3, "np": 3, "_description_": 3, "option": [3, 13, 17], "rais": 3, "valueerror": 3, "error": [3, 8], "incas": 3, "valid": [3, 9, 10, 16, 17], "larger": 3, "than": 3, "preprocess_jnp": [3, 4, 16], "trainload": 3, "dataload": 3, "testload": 3, "pytorch": 3, "torch": 3, "trainset": 3, "loader": [3, 6], "testset": 3, "random_split": [4, 6, 16], "phi": [5, 18], "zzzz": 5, "e": 5, "z": 5, "otimes4": 5, "argument": [5, 9, 17], "angl": [5, 18], "diagon": 5, "matrix": 5, "id": [5, 18], "static": [5, 18], "represent": [5, 18], "product": [5, 18], "other": [5, 18], "method": [5, 9, 18], "o": [5, 18], "o_1": [5, 18], "o_2": [5, 18], "dot": [5, 18], "o_n": [5, 18], "make": [5, 18], "up": [5, 18], "decomposit": [5, 18], "queu": [5, 18], "within": [5, 18], "param": [5, 18], "attribut": [5, 18], "iter": [5, 18], "ani": [5, 9, 13, 17, 18], "act": [5, 18], "hyperparam": [5, 18], "dict": [5, 9, 13, 17, 18], "non": [5, 13, 17, 18], "hyperparamet": [5, 17, 18], "A": [5, 18], "5": [5, 17], "6": [5, 18], "3": 5, "4": 5, "transform": [6, 15], "target_transform": 6, "download": [6, 15], "fals": [6, 13, 15], "imagefold": 6, "ratio": 6, "random_st": 6, "about": [], "usag": [], "cite": [], "licens": [], "contact": [], "src": 11, "index": 7, "search": 7, "page": 7, "bce_loss": [8, 10, 16, 17], "measur": [8, 13, 17], "between": 8, "each": [8, 17], "element": 8, "one": [8, 9], "hot": 8, "encod": 8, "target": 8, "y": 8, "given": [8, 9, 13], "equat": 8, "ell": 8, "sum_": 8, "n_": 8, "mathbf": 8, "_n": 8, "cdot": 8, "log": 8, "mse_loss": [8, 10, 16], "mean": 8, "squar": 8, "mse": 8, "ell_": 8, "text": 8, "frac": 8, "sqrt": 8, "left": 8, "x_n": 8, "y_n": 8, "right": 8, "accuraci": [8, 10, 16, 17], "pred": [8, 17], "predict": [8, 17], "cacul": 8, "get_metr": [8, 10, 16], "callabl": [8, 9, 11, 12, 13], "choose_model": [9, 10, 16], "model_typ": 9, "model_arg": [9, 17], "pick": 9, "hyperparmaet": 9, "arg": [9, 13], "create_st": [9, 10, 16], "rng": [9, 12], "model_cl": 9, "input_shap": 9, "input_arg": 9, "opt_arg": [9, 17], "trainstat": [9, 17], "creat": 9, "state": [9, 17], "prngkei": [9, 12], "random": [9, 12, 17], "gener": [9, 12, 13, 17], "kei": [9, 12], "nn": 9, "flax": [9, 12], "init_trainst": [9, 10, 16], "print_loss": [9, 10, 16], "train_loss": [9, 17], "valid_loss": 9, "print": [9, 17], "total": [9, 13, 17], "epohc": 9, "save_output": [9, 10, 16], "snapshot_dir": [9, 17], "metric": [7, 10, 16, 17], "model_util": [7, 10, 16], "qcnn_classifi": [7, 10, 16], "qcnnclassifi": [10, 12, 16], "init_param": [10, 12, 16], "parent": [10, 12, 16], "scope": [10, 12, 16], "compute_metr": [10, 16, 17], "train_batch": [10, 16, 17], "train_model": [10, 16, 17], "num_qubit": [11, 13], "num_measur": [11, 13, 17], "bool": [11, 12, 13], "kwarg": [11, 13], "object": [11, 12], "suchang": 11, "sy_phd": 11, "git_repo": 11, "equiv_qnn_architectur": 11, "json": 11, "true": [11, 13, 15, 17], "qnn_architectur": 11, "linen": 12, "core": 12, "_sentinel": 12, "num_qparam": 12, "includ": 13, "final": 13, "In": 13, "ceil": 13, "log2": 13, "num_class": 13, "qnn_config": 13, "layer": [13, 17], "total_num_param": 13, "requir": [13, 17], "autoencod": 14, "handwritten": 15, "digit": 15, "2008": 15, "uci": 15, "machin": 15, "doi": 15, "org": 15, "10": [15, 18], "24432": 15, "c5sc8v": 15, "seed": [15, 17], "42": 15, "initialize_log": [7, 16, 19], "comput": 17, "moment": 17, "ground": 17, "truth": 17, "conatin": 17, "respect": 17, "we": 17, "take": 17, "gradient": 17, "dictionari": 17, "x_batch": 17, "y_batch": 17, "model_st": 17, "singl": 17, "updat": 17, "train_d": 17, "test_d": 17, "train_arg": 17, "equivaraint": 17, "provid": 17, "need": 17, "point": 17, "num_epoch": 17, "batch_siz": 17, "string": 17, "support": 17, "For": 17, "lceil": 17, "log_2": 17, "rceil": 17, "otherwis": 17, "filter": 17, "share": 17, "ident": 17, "differ": 17, "optim_arg": 17, "optax": 17, "learning_r": 17, "": 17, "progress": 17, "specifi": 17, "exampl": 17, "1024": 17, "8": 17, "noisy_equiv": 17, "01": 17, "test_loss": 17, "6449261327584586": 17, "600408172607422": 17, "5616568744182586": 17, "5470444520314535": 17, "537257703145345": 17, "6750000019868214": 17, "7497685273488361": 17, "8037037114302319": 17, "8217592616875966": 17, "8263888935248058": 17, "math": 17, "Not": 17, "ansatz": 18, "benchmark": 18, "perform": 18, "hur": 18, "t": 18, "kim": 18, "park": 18, "d": 18, "k": 18}, "objects": {"": [[2, 0, 0, "-", "data_embedding"], [3, 0, 0, "-", "dataset"], [5, 0, 0, "-", "equiv_unitary"], [6, 0, 0, "-", "eurosat"], [8, 0, 0, "-", "metrics"], [9, 0, 0, "-", "model_utils"], [11, 0, 0, "-", "qcnn"], [12, 0, 0, "-", "qcnn_classifier"], [13, 0, 0, "-", "quantum_circuit"], [14, 0, 0, "-", "run"], [15, 0, 0, "-", "semeion"], [17, 0, 0, "-", "train"], [18, 0, 0, "-", "unitary"], [19, 0, 0, "-", "utils"]], "data_embedding": [[2, 1, 1, "", "embed_image"]], "dataset": [[3, 1, 1, "", "get_data"], [3, 1, 1, "", "load_ising_data"], [3, 1, 1, "", "prepare_ising_data"], [3, 1, 1, "", "preprocess_jnp"]], "equiv_unitary": [[5, 1, 1, "", "IsingZ4"], [5, 2, 1, "", "Pooling_ansatz"], [5, 2, 1, "", "equiv_U2"], [5, 2, 1, "", "equiv_U4"]], "equiv_unitary.Pooling_ansatz": [[5, 3, 1, "", "compute_decomposition"], [5, 4, 1, "", "grad_method"], [5, 4, 1, "", "ndim_params"], [5, 4, 1, "", "num_params"], [5, 4, 1, "", "num_wires"]], "equiv_unitary.equiv_U2": [[5, 3, 1, "", "compute_decomposition"], [5, 4, 1, "", "grad_method"], [5, 4, 1, "", "ndim_params"], [5, 4, 1, "", "num_params"], [5, 4, 1, "", "num_wires"]], "equiv_unitary.equiv_U4": [[5, 3, 1, "", "compute_decomposition"], [5, 4, 1, "", "grad_method"], [5, 4, 1, "", "ndim_params"], [5, 4, 1, "", "num_params"], [5, 4, 1, "", "num_wires"]], "eurosat": [[6, 2, 1, "", "EuroSAT"], [6, 1, 1, "", "random_split"]], "metrics": [[8, 1, 1, "", "BCE_loss"], [8, 1, 1, "", "MSE_loss"], [8, 1, 1, "", "accuracy"], [8, 1, 1, "", "get_metrics"]], "model_utils": [[9, 1, 1, "", "choose_model"], [9, 1, 1, "", "create_state"], [9, 1, 1, "", "init_trainstate"], [9, 1, 1, "", "print_losses"], [9, 1, 1, "", "save_outputs"]], "qcnn": [[11, 2, 1, "", "EquivQCNN"], [11, 2, 1, "", "QCNN"]], "qcnn.EquivQCNN": [[11, 3, 1, "", "get_circuit"], [11, 4, 1, "", "qnn_config_path"]], "qcnn.QCNN": [[11, 3, 1, "", "get_circuit"], [11, 4, 1, "", "qnn_config_path"]], "qcnn_classifier": [[12, 2, 1, "", "QCNNClassifier"]], "qcnn_classifier.QCNNClassifier": [[12, 4, 1, "", "circuit"], [12, 4, 1, "", "delta"], [12, 4, 1, "", "equiv"], [12, 3, 1, "", "init_params"], [12, 4, 1, "", "name"], [12, 4, 1, "", "num_params"], [12, 4, 1, "", "parent"], [12, 4, 1, "", "scope"]], "quantum_circuit": [[13, 1, 1, "", "get_quantum_circuit"]], "semeion": [[15, 2, 1, "", "Semeion"]], "train": [[17, 1, 1, "", "compute_metrics"], [17, 1, 1, "", "train_batch"], [17, 1, 1, "", "train_model"], [17, 1, 1, "", "validate"]], "unitary": [[18, 2, 1, "", "Pooling_ansatz"], [18, 2, 1, "", "U_6"], [18, 2, 1, "", "U_SO4"], [18, 2, 1, "", "U_TTN"]], "unitary.Pooling_ansatz": [[18, 3, 1, "", "compute_decomposition"], [18, 4, 1, "", "grad_method"], [18, 4, 1, "", "ndim_params"], [18, 4, 1, "", "num_params"], [18, 4, 1, "", "num_wires"]], "unitary.U_6": [[18, 3, 1, "", "compute_decomposition"], [18, 4, 1, "", "grad_method"], [18, 4, 1, "", "ndim_params"], [18, 4, 1, "", "num_params"], [18, 4, 1, "", "num_wires"]], "unitary.U_SO4": [[18, 3, 1, "", "compute_decomposition"], [18, 4, 1, "", "grad_method"], [18, 4, 1, "", "ndim_params"], [18, 4, 1, "", "num_params"], [18, 4, 1, "", "num_wires"]], "unitary.U_TTN": [[18, 3, 1, "", "compute_decomposition"], [18, 4, 1, "", "grad_method"], [18, 4, 1, "", "ndim_params"], [18, 4, 1, "", "num_params"], [18, 4, 1, "", "num_wires"]], "utils": [[19, 1, 1, "", "initialize_logging"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"about": [0, 7], "code": [0, 7], "usag": [0, 7], "cite": [0, 7], "licens": [0, 7], "contact": [0, 7], "circuit": 1, "data_embed": 2, "modul": [2, 3, 5, 6, 8, 9, 11, 12, 13, 14, 15, 17, 18, 19], "dataset": [3, 4], "equiv_unitari": 5, "eurosat": 6, "welcom": [], "approxim": [], "equivari": 7, "qcnn": [7, 11], "under": [], "p4m": [], "group": [], "symmetri": [], "imag": 7, "": [], "document": [], "content": [], "indic": 7, "tabl": 7, "metric": 8, "model_util": 9, "model": 10, "qcnn_classifi": 12, "quantum_circuit": 13, "run": 14, "semeion": 15, "src": 16, "train": 17, "unitari": 18, "util": 19, "quantum": 7, "convolut": 7, "neural": 7, "network": 7}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"About the codes": [[0, "about-the-codes"], [7, "about-the-codes"]], "Usage": [[0, "usage"], [7, "usage"]], "Cite": [[0, "cite"], [7, "cite"]], "License": [[0, "license"], [7, "license"]], "Contact": [[0, "contact"], [7, "contact"]], "circuits": [[1, "circuits"]], "data_embedding module": [[2, "module-data_embedding"]], "dataset module": [[3, "module-dataset"]], "datasets": [[4, "datasets"]], "equiv_unitary module": [[5, "module-equiv_unitary"]], "eurosat module": [[6, "module-eurosat"]], "metrics module": [[8, "module-metrics"]], "model_utils module": [[9, "module-model_utils"]], "models": [[10, "models"]], "qcnn module": [[11, "module-qcnn"]], "qcnn_classifier module": [[12, "module-qcnn_classifier"]], "quantum_circuit module": [[13, "module-quantum_circuit"]], "run module": [[14, "module-run"]], "semeion module": [[15, "module-semeion"]], "src": [[16, "src"]], "train module": [[17, "module-train"]], "unitary module": [[18, "module-unitary"]], "utils module": [[19, "module-utils"]], "Equivariant QCNN for images": [[7, "equivariant-qcnn-for-images"]], "Equivariant Quantum Convolutional Neural Networks:": [[7, null]], "Indices and tables": [[7, "indices-and-tables"]]}, "indexentries": {}})